{"ast":null,"code":"import _regeneratorRuntime from\"/Users/zorro/Downloads/Flowise/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/zorro/Downloads/Flowise/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/Users/zorro/Downloads/Flowise/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/Users/zorro/Downloads/Flowise/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/zorro/Downloads/Flowise/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{createPortal}from'react-dom';import{useState,useEffect,useCallback,useMemo}from'react';import{useDispatch,useSelector}from'react-redux';import{enqueueSnackbar as enqueueSnackbarAction,closeSnackbar as closeSnackbarAction}from'store/actions';import{cloneDeep}from'lodash';import{Box,Typography,Button,Dialog,DialogActions,DialogContent,DialogTitle,Stack,OutlinedInput}from'@mui/material';import{StyledButton}from'ui-component/button/StyledButton';import{Grid}from'ui-component/grid/Grid';import{TooltipWithParser}from'ui-component/tooltip/TooltipWithParser';import{GridActionsCellItem}from'@mui/x-data-grid';import DeleteIcon from'@mui/icons-material/Delete';import ConfirmDialog from'ui-component/dialog/ConfirmDialog';import{DarkCodeEditor}from'ui-component/editor/DarkCodeEditor';import{LightCodeEditor}from'ui-component/editor/LightCodeEditor';import{useTheme}from'@mui/material/styles';// Icons\nimport{IconX,IconFileExport}from'@tabler/icons';// API\nimport toolsApi from'api/tools';// Hooks\nimport useConfirm from'hooks/useConfirm';import useApi from'hooks/useApi';// utils\nimport useNotifier from'utils/useNotifier';import{generateRandomGradient}from'utils/genericHelper';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var exampleAPIFunc=\"/*\\n* You can use any libraries imported in Flowise\\n* You can use properties specified in Output Schema as variables. Ex: Property = userid, Variable = $userid\\n* Must return a string value at the end of function\\n*/\\n\\nconst fetch = require('node-fetch');\\nconst url = 'https://api.open-meteo.com/v1/forecast?latitude=52.52&longitude=13.41&current_weather=true';\\nconst options = {\\n    method: 'GET',\\n    headers: {\\n        'Content-Type': 'application/json'\\n    }\\n};\\ntry {\\n    const response = await fetch(url, options);\\n    const text = await response.text();\\n    return text;\\n} catch (error) {\\n    console.error(error);\\n    return '';\\n}\";var ToolDialog=function ToolDialog(_ref){var show=_ref.show,dialogProps=_ref.dialogProps,onUseTemplate=_ref.onUseTemplate,onCancel=_ref.onCancel,onConfirm=_ref.onConfirm;var portalElement=document.getElementById('portal');var theme=useTheme();var customization=useSelector(function(state){return state.customization;});var dispatch=useDispatch();// ==============================|| Snackbar ||============================== //\nuseNotifier();var _useConfirm=useConfirm(),confirm=_useConfirm.confirm;var enqueueSnackbar=function enqueueSnackbar(){return dispatch(enqueueSnackbarAction.apply(void 0,arguments));};var closeSnackbar=function closeSnackbar(){return dispatch(closeSnackbarAction.apply(void 0,arguments));};var getSpecificToolApi=useApi(toolsApi.getSpecificTool);var _useState=useState(''),_useState2=_slicedToArray(_useState,2),toolId=_useState2[0],setToolId=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),toolName=_useState4[0],setToolName=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),toolDesc=_useState6[0],setToolDesc=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),toolIcon=_useState8[0],setToolIcon=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),toolSchema=_useState10[0],setToolSchema=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),toolFunc=_useState12[0],setToolFunc=_useState12[1];var deleteItem=useCallback(function(id){return function(){setTimeout(function(){setToolSchema(function(prevRows){return prevRows.filter(function(row){return row.id!==id;});});});};},[]);var addNewRow=function addNewRow(){setTimeout(function(){setToolSchema(function(prevRows){var allRows=_toConsumableArray(cloneDeep(prevRows));var lastRowId=allRows.length?allRows[allRows.length-1].id+1:1;allRows.push({id:lastRowId,property:'',description:'',type:'',required:false});return allRows;});});};var onRowUpdate=function onRowUpdate(newRow){setTimeout(function(){setToolSchema(function(prevRows){var allRows=_toConsumableArray(cloneDeep(prevRows));var indexToUpdate=allRows.findIndex(function(row){return row.id===newRow.id;});if(indexToUpdate>=0){allRows[indexToUpdate]=_objectSpread({},newRow);}return allRows;});});};var columns=useMemo(function(){return[{field:'property',headerName:'Property',editable:true,flex:1},{field:'type',headerName:'Type',type:'singleSelect',valueOptions:['string','number','boolean','date'],editable:true,width:120},{field:'description',headerName:'Description',editable:true,flex:1},{field:'required',headerName:'Required',type:'boolean',editable:true,width:80},{field:'actions',type:'actions',width:80,getActions:function getActions(params){return[/*#__PURE__*/_jsx(GridActionsCellItem,{icon:/*#__PURE__*/_jsx(DeleteIcon,{}),label:\"Delete\",onClick:deleteItem(params.id)},'Delete')];}}];},[deleteItem]);var formatSchema=function formatSchema(schema){try{var parsedSchema=JSON.parse(schema);return parsedSchema.map(function(sch,index){return _objectSpread(_objectSpread({},sch),{},{id:index});});}catch(e){return[];}};useEffect(function(){if(getSpecificToolApi.data){setToolId(getSpecificToolApi.data.id);setToolName(getSpecificToolApi.data.name);setToolDesc(getSpecificToolApi.data.description);setToolSchema(formatSchema(getSpecificToolApi.data.schema));if(getSpecificToolApi.data.func)setToolFunc(getSpecificToolApi.data.func);else setToolFunc('');}},[getSpecificToolApi.data]);useEffect(function(){if(dialogProps.type==='EDIT'&&dialogProps.data){// When tool dialog is opened from Tools dashboard\nsetToolId(dialogProps.data.id);setToolName(dialogProps.data.name);setToolDesc(dialogProps.data.description);setToolIcon(dialogProps.data.iconSrc);setToolSchema(formatSchema(dialogProps.data.schema));if(dialogProps.data.func)setToolFunc(dialogProps.data.func);else setToolFunc('');}else if(dialogProps.type==='EDIT'&&dialogProps.toolId){// When tool dialog is opened from CustomTool node in canvas\ngetSpecificToolApi.request(dialogProps.toolId);}else if(dialogProps.type==='IMPORT'&&dialogProps.data){// When tool dialog is to import existing tool\nsetToolName(dialogProps.data.name);setToolDesc(dialogProps.data.description);setToolIcon(dialogProps.data.iconSrc);setToolSchema(formatSchema(dialogProps.data.schema));if(dialogProps.data.func)setToolFunc(dialogProps.data.func);else setToolFunc('');}else if(dialogProps.type==='TEMPLATE'&&dialogProps.data){// When tool dialog is a template\nsetToolName(dialogProps.data.name);setToolDesc(dialogProps.data.description);setToolIcon(dialogProps.data.iconSrc);setToolSchema(formatSchema(dialogProps.data.schema));if(dialogProps.data.func)setToolFunc(dialogProps.data.func);else setToolFunc('');}else if(dialogProps.type==='ADD'){// When tool dialog is to add a new tool\nsetToolId('');setToolName('');setToolDesc('');setToolIcon('');setToolSchema([]);setToolFunc('');}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[dialogProps]);var useToolTemplate=function useToolTemplate(){onUseTemplate(dialogProps.data);};var exportTool=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var toolResp,toolData,dataStr,dataUri,exportFileDefaultName,linkElement,errorData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return toolsApi.getSpecificTool(toolId);case 3:toolResp=_context.sent;if(toolResp.data){toolData=toolResp.data;delete toolData.id;delete toolData.createdDate;delete toolData.updatedDate;dataStr=JSON.stringify(toolData);dataUri='data:application/json;charset=utf-8,'+encodeURIComponent(dataStr);exportFileDefaultName=\"\".concat(toolName,\"-CustomTool.json\");linkElement=document.createElement('a');linkElement.setAttribute('href',dataUri);linkElement.setAttribute('download',exportFileDefaultName);linkElement.click();}_context.next=12;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);errorData=_context.t0.response.data||\"\".concat(_context.t0.response.status,\": \").concat(_context.t0.response.statusText);enqueueSnackbar({message:\"Failed to export Tool: \".concat(errorData),options:{key:new Date().getTime()+Math.random(),variant:'error',persist:true,action:function action(key){return/*#__PURE__*/_jsx(Button,{style:{color:'white'},onClick:function onClick(){return closeSnackbar(key);},children:/*#__PURE__*/_jsx(IconX,{})});}}});onCancel();case 12:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function exportTool(){return _ref2.apply(this,arguments);};}();var addNewTool=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var obj,createResp,errorData;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;obj={name:toolName,description:toolDesc,color:generateRandomGradient(),schema:JSON.stringify(toolSchema),func:toolFunc,iconSrc:toolIcon};_context2.next=4;return toolsApi.createNewTool(obj);case 4:createResp=_context2.sent;if(createResp.data){enqueueSnackbar({message:'New Tool added',options:{key:new Date().getTime()+Math.random(),variant:'success',action:function action(key){return/*#__PURE__*/_jsx(Button,{style:{color:'white'},onClick:function onClick(){return closeSnackbar(key);},children:/*#__PURE__*/_jsx(IconX,{})});}}});onConfirm(createResp.data.id);}_context2.next=13;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);errorData=_context2.t0.response.data||\"\".concat(_context2.t0.response.status,\": \").concat(_context2.t0.response.statusText);enqueueSnackbar({message:\"Failed to add new Tool: \".concat(errorData),options:{key:new Date().getTime()+Math.random(),variant:'error',persist:true,action:function action(key){return/*#__PURE__*/_jsx(Button,{style:{color:'white'},onClick:function onClick(){return closeSnackbar(key);},children:/*#__PURE__*/_jsx(IconX,{})});}}});onCancel();case 13:case\"end\":return _context2.stop();}},_callee2,null,[[0,8]]);}));return function addNewTool(){return _ref3.apply(this,arguments);};}();var saveTool=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var saveResp,errorData;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return toolsApi.updateTool(toolId,{name:toolName,description:toolDesc,schema:JSON.stringify(toolSchema),func:toolFunc,iconSrc:toolIcon});case 3:saveResp=_context3.sent;if(saveResp.data){enqueueSnackbar({message:'Tool saved',options:{key:new Date().getTime()+Math.random(),variant:'success',action:function action(key){return/*#__PURE__*/_jsx(Button,{style:{color:'white'},onClick:function onClick(){return closeSnackbar(key);},children:/*#__PURE__*/_jsx(IconX,{})});}}});onConfirm(saveResp.data.id);}_context3.next=13;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);console.error(_context3.t0);errorData=_context3.t0.response.data||\"\".concat(_context3.t0.response.status,\": \").concat(_context3.t0.response.statusText);enqueueSnackbar({message:\"Failed to save Tool: \".concat(errorData),options:{key:new Date().getTime()+Math.random(),variant:'error',persist:true,action:function action(key){return/*#__PURE__*/_jsx(Button,{style:{color:'white'},onClick:function onClick(){return closeSnackbar(key);},children:/*#__PURE__*/_jsx(IconX,{})});}}});onCancel();case 13:case\"end\":return _context3.stop();}},_callee3,null,[[0,7]]);}));return function saveTool(){return _ref4.apply(this,arguments);};}();var deleteTool=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){var confirmPayload,isConfirmed,delResp,errorData;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:confirmPayload={title:\"Delete Tool\",description:\"Delete tool \".concat(toolName,\"?\"),confirmButtonName:'Delete',cancelButtonName:'Cancel'};_context4.next=3;return confirm(confirmPayload);case 3:isConfirmed=_context4.sent;if(!isConfirmed){_context4.next=17;break;}_context4.prev=5;_context4.next=8;return toolsApi.deleteTool(toolId);case 8:delResp=_context4.sent;if(delResp.data){enqueueSnackbar({message:'Tool deleted',options:{key:new Date().getTime()+Math.random(),variant:'success',action:function action(key){return/*#__PURE__*/_jsx(Button,{style:{color:'white'},onClick:function onClick(){return closeSnackbar(key);},children:/*#__PURE__*/_jsx(IconX,{})});}}});onConfirm();}_context4.next=17;break;case 12:_context4.prev=12;_context4.t0=_context4[\"catch\"](5);errorData=_context4.t0.response.data||\"\".concat(_context4.t0.response.status,\": \").concat(_context4.t0.response.statusText);enqueueSnackbar({message:\"Failed to delete Tool: \".concat(errorData),options:{key:new Date().getTime()+Math.random(),variant:'error',persist:true,action:function action(key){return/*#__PURE__*/_jsx(Button,{style:{color:'white'},onClick:function onClick(){return closeSnackbar(key);},children:/*#__PURE__*/_jsx(IconX,{})});}}});onCancel();case 17:case\"end\":return _context4.stop();}},_callee4,null,[[5,12]]);}));return function deleteTool(){return _ref5.apply(this,arguments);};}();var component=show?/*#__PURE__*/_jsxs(Dialog,{fullWidth:true,maxWidth:\"md\",open:show,onClose:onCancel,\"aria-labelledby\":\"alert-dialog-title\",\"aria-describedby\":\"alert-dialog-description\",children:[/*#__PURE__*/_jsx(DialogTitle,{sx:{fontSize:'1rem'},id:\"alert-dialog-title\",children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'row'},children:[dialogProps.title,/*#__PURE__*/_jsx(\"div\",{style:{flex:1}}),dialogProps.type==='EDIT'&&/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:function onClick(){return exportTool();},startIcon:/*#__PURE__*/_jsx(IconFileExport,{}),children:\"Export\"})]})}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsxs(Box,{sx:{p:2},children:[/*#__PURE__*/_jsx(Stack,{sx:{position:'relative'},direction:\"row\",children:/*#__PURE__*/_jsxs(Typography,{variant:\"overline\",children:[\"Tool Name\",/*#__PURE__*/_jsx(\"span\",{style:{color:'red'},children:\"\\xA0*\"}),/*#__PURE__*/_jsx(TooltipWithParser,{style:{marginLeft:10},title:'Tool name must be small capital letter with underscore. Ex: my_tool'})]})}),/*#__PURE__*/_jsx(OutlinedInput,{id:\"toolName\",type:\"string\",fullWidth:true,disabled:dialogProps.type==='TEMPLATE',placeholder:\"My New Tool\",value:toolName,name:\"toolName\",onChange:function onChange(e){return setToolName(e.target.value);}})]}),/*#__PURE__*/_jsxs(Box,{sx:{p:2},children:[/*#__PURE__*/_jsx(Stack,{sx:{position:'relative'},direction:\"row\",children:/*#__PURE__*/_jsxs(Typography,{variant:\"overline\",children:[\"Tool description\",/*#__PURE__*/_jsx(\"span\",{style:{color:'red'},children:\"\\xA0*\"}),/*#__PURE__*/_jsx(TooltipWithParser,{style:{marginLeft:10},title:'Description of what the tool does. This is for ChatGPT to determine when to use this tool.'})]})}),/*#__PURE__*/_jsx(OutlinedInput,{id:\"toolDesc\",type:\"string\",fullWidth:true,disabled:dialogProps.type==='TEMPLATE',placeholder:\"Description of what the tool does. This is for ChatGPT to determine when to use this tool.\",multiline:true,rows:3,value:toolDesc,name:\"toolDesc\",onChange:function onChange(e){return setToolDesc(e.target.value);}})]}),/*#__PURE__*/_jsxs(Box,{sx:{p:2},children:[/*#__PURE__*/_jsx(Stack,{sx:{position:'relative'},direction:\"row\",children:/*#__PURE__*/_jsx(Typography,{variant:\"overline\",children:\"Tool Icon Src\"})}),/*#__PURE__*/_jsx(OutlinedInput,{id:\"toolIcon\",type:\"string\",fullWidth:true,disabled:dialogProps.type==='TEMPLATE',placeholder:\"https://raw.githubusercontent.com/gilbarbara/logos/main/logos/airtable.svg\",value:toolIcon,name:\"toolIcon\",onChange:function onChange(e){return setToolIcon(e.target.value);}})]}),/*#__PURE__*/_jsxs(Box,{sx:{p:2},children:[/*#__PURE__*/_jsx(Stack,{sx:{position:'relative'},direction:\"row\",children:/*#__PURE__*/_jsxs(Typography,{variant:\"overline\",children:[\"Output Schema\",/*#__PURE__*/_jsx(TooltipWithParser,{style:{marginLeft:10},title:'What should be the output response in JSON format?'})]})}),/*#__PURE__*/_jsx(Grid,{columns:columns,rows:toolSchema,disabled:dialogProps.type==='TEMPLATE',addNewRow:addNewRow,onRowUpdate:onRowUpdate})]}),/*#__PURE__*/_jsxs(Box,{sx:{p:2},children:[/*#__PURE__*/_jsx(Stack,{sx:{position:'relative'},direction:\"row\",children:/*#__PURE__*/_jsxs(Typography,{variant:\"overline\",children:[\"Javascript Function\",/*#__PURE__*/_jsx(TooltipWithParser,{style:{marginLeft:10},title:\"Function to execute when tool is being used. You can use properties specified in Output Schema as variables. For example, if the property is <code>userid</code>, you can use as <code>$userid</code>. Return value must be a string.\"})]})}),dialogProps.type!=='TEMPLATE'&&/*#__PURE__*/_jsx(Button,{style:{marginBottom:10},variant:\"outlined\",onClick:function onClick(){return setToolFunc(exampleAPIFunc);},children:\"See Example\"}),customization.isDarkMode?/*#__PURE__*/_jsx(DarkCodeEditor,{value:toolFunc,disabled:dialogProps.type==='TEMPLATE',onValueChange:function onValueChange(code){return setToolFunc(code);},style:{fontSize:'0.875rem',minHeight:'calc(100vh - 220px)',width:'100%',borderRadius:5}}):/*#__PURE__*/_jsx(LightCodeEditor,{value:toolFunc,disabled:dialogProps.type==='TEMPLATE',onValueChange:function onValueChange(code){return setToolFunc(code);},style:{fontSize:'0.875rem',minHeight:'calc(100vh - 220px)',width:'100%',border:\"1px solid \".concat(theme.palette.grey[300]),borderRadius:5}})]})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[dialogProps.type==='EDIT'&&/*#__PURE__*/_jsx(StyledButton,{color:\"error\",variant:\"contained\",onClick:function onClick(){return deleteTool();},children:\"Delete\"}),dialogProps.type==='TEMPLATE'&&/*#__PURE__*/_jsx(StyledButton,{color:\"secondary\",variant:\"contained\",onClick:useToolTemplate,children:\"Use Template\"}),dialogProps.type!=='TEMPLATE'&&/*#__PURE__*/_jsx(StyledButton,{disabled:!(toolName&&toolDesc),variant:\"contained\",onClick:function onClick(){return dialogProps.type==='ADD'||dialogProps.type==='IMPORT'?addNewTool():saveTool();},children:dialogProps.confirmButtonName})]}),/*#__PURE__*/_jsx(ConfirmDialog,{})]}):null;return/*#__PURE__*/createPortal(component,portalElement);};export default ToolDialog;","map":{"version":3,"names":["createPortal","useState","useEffect","useCallback","useMemo","useDispatch","useSelector","enqueueSnackbar","enqueueSnackbarAction","closeSnackbar","closeSnackbarAction","cloneDeep","Box","Typography","Button","Dialog","DialogActions","DialogContent","DialogTitle","Stack","OutlinedInput","StyledButton","Grid","TooltipWithParser","GridActionsCellItem","DeleteIcon","ConfirmDialog","DarkCodeEditor","LightCodeEditor","useTheme","IconX","IconFileExport","toolsApi","useConfirm","useApi","useNotifier","generateRandomGradient","jsx","_jsx","jsxs","_jsxs","exampleAPIFunc","ToolDialog","_ref","show","dialogProps","onUseTemplate","onCancel","onConfirm","portalElement","document","getElementById","theme","customization","state","dispatch","_useConfirm","confirm","apply","arguments","getSpecificToolApi","getSpecificTool","_useState","_useState2","_slicedToArray","toolId","setToolId","_useState3","_useState4","toolName","setToolName","_useState5","_useState6","toolDesc","setToolDesc","_useState7","_useState8","toolIcon","setToolIcon","_useState9","_useState10","toolSchema","setToolSchema","_useState11","_useState12","toolFunc","setToolFunc","deleteItem","id","setTimeout","prevRows","filter","row","addNewRow","allRows","_toConsumableArray","lastRowId","length","push","property","description","type","required","onRowUpdate","newRow","indexToUpdate","findIndex","_objectSpread","columns","field","headerName","editable","flex","valueOptions","width","getActions","params","icon","label","onClick","formatSchema","schema","parsedSchema","JSON","parse","map","sch","index","e","data","name","func","iconSrc","request","useToolTemplate","exportTool","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","toolResp","toolData","dataStr","dataUri","exportFileDefaultName","linkElement","errorData","wrap","_callee$","_context","prev","next","sent","createdDate","updatedDate","stringify","encodeURIComponent","concat","createElement","setAttribute","click","t0","response","status","statusText","message","options","key","Date","getTime","Math","random","variant","persist","action","style","color","children","stop","addNewTool","_ref3","_callee2","obj","createResp","_callee2$","_context2","createNewTool","saveTool","_ref4","_callee3","saveResp","_callee3$","_context3","updateTool","console","error","deleteTool","_ref5","_callee4","confirmPayload","isConfirmed","delResp","_callee4$","_context4","title","confirmButtonName","cancelButtonName","component","fullWidth","maxWidth","open","onClose","sx","fontSize","display","flexDirection","startIcon","p","position","direction","marginLeft","disabled","placeholder","value","onChange","target","multiline","rows","marginBottom","isDarkMode","onValueChange","code","minHeight","borderRadius","border","palette","grey"],"sources":["/Users/zorro/Downloads/Flowise/packages/ui/src/views/tools/ToolDialog.js"],"sourcesContent":["import { createPortal } from 'react-dom'\nimport PropTypes from 'prop-types'\nimport { useState, useEffect, useCallback, useMemo } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { enqueueSnackbar as enqueueSnackbarAction, closeSnackbar as closeSnackbarAction } from 'store/actions'\nimport { cloneDeep } from 'lodash'\n\nimport { Box, Typography, Button, Dialog, DialogActions, DialogContent, DialogTitle, Stack, OutlinedInput } from '@mui/material'\nimport { StyledButton } from 'ui-component/button/StyledButton'\nimport { Grid } from 'ui-component/grid/Grid'\nimport { TooltipWithParser } from 'ui-component/tooltip/TooltipWithParser'\nimport { GridActionsCellItem } from '@mui/x-data-grid'\nimport DeleteIcon from '@mui/icons-material/Delete'\nimport ConfirmDialog from 'ui-component/dialog/ConfirmDialog'\nimport { DarkCodeEditor } from 'ui-component/editor/DarkCodeEditor'\nimport { LightCodeEditor } from 'ui-component/editor/LightCodeEditor'\nimport { useTheme } from '@mui/material/styles'\n\n// Icons\nimport { IconX, IconFileExport } from '@tabler/icons'\n\n// API\nimport toolsApi from 'api/tools'\n\n// Hooks\nimport useConfirm from 'hooks/useConfirm'\nimport useApi from 'hooks/useApi'\n\n// utils\nimport useNotifier from 'utils/useNotifier'\nimport { generateRandomGradient } from 'utils/genericHelper'\n\nconst exampleAPIFunc = `/*\n* You can use any libraries imported in Flowise\n* You can use properties specified in Output Schema as variables. Ex: Property = userid, Variable = $userid\n* Must return a string value at the end of function\n*/\n\nconst fetch = require('node-fetch');\nconst url = 'https://api.open-meteo.com/v1/forecast?latitude=52.52&longitude=13.41&current_weather=true';\nconst options = {\n    method: 'GET',\n    headers: {\n        'Content-Type': 'application/json'\n    }\n};\ntry {\n    const response = await fetch(url, options);\n    const text = await response.text();\n    return text;\n} catch (error) {\n    console.error(error);\n    return '';\n}`\n\nconst ToolDialog = ({ show, dialogProps, onUseTemplate, onCancel, onConfirm }) => {\n    const portalElement = document.getElementById('portal')\n    const theme = useTheme()\n\n    const customization = useSelector((state) => state.customization)\n    const dispatch = useDispatch()\n\n    // ==============================|| Snackbar ||============================== //\n\n    useNotifier()\n    const { confirm } = useConfirm()\n\n    const enqueueSnackbar = (...args) => dispatch(enqueueSnackbarAction(...args))\n    const closeSnackbar = (...args) => dispatch(closeSnackbarAction(...args))\n\n    const getSpecificToolApi = useApi(toolsApi.getSpecificTool)\n\n    const [toolId, setToolId] = useState('')\n    const [toolName, setToolName] = useState('')\n    const [toolDesc, setToolDesc] = useState('')\n    const [toolIcon, setToolIcon] = useState('')\n    const [toolSchema, setToolSchema] = useState([])\n    const [toolFunc, setToolFunc] = useState('')\n\n    const deleteItem = useCallback(\n        (id) => () => {\n            setTimeout(() => {\n                setToolSchema((prevRows) => prevRows.filter((row) => row.id !== id))\n            })\n        },\n        []\n    )\n\n    const addNewRow = () => {\n        setTimeout(() => {\n            setToolSchema((prevRows) => {\n                let allRows = [...cloneDeep(prevRows)]\n                const lastRowId = allRows.length ? allRows[allRows.length - 1].id + 1 : 1\n                allRows.push({\n                    id: lastRowId,\n                    property: '',\n                    description: '',\n                    type: '',\n                    required: false\n                })\n                return allRows\n            })\n        })\n    }\n\n    const onRowUpdate = (newRow) => {\n        setTimeout(() => {\n            setToolSchema((prevRows) => {\n                let allRows = [...cloneDeep(prevRows)]\n                const indexToUpdate = allRows.findIndex((row) => row.id === newRow.id)\n                if (indexToUpdate >= 0) {\n                    allRows[indexToUpdate] = { ...newRow }\n                }\n                return allRows\n            })\n        })\n    }\n\n    const columns = useMemo(\n        () => [\n            { field: 'property', headerName: 'Property', editable: true, flex: 1 },\n            {\n                field: 'type',\n                headerName: 'Type',\n                type: 'singleSelect',\n                valueOptions: ['string', 'number', 'boolean', 'date'],\n                editable: true,\n                width: 120\n            },\n            { field: 'description', headerName: 'Description', editable: true, flex: 1 },\n            { field: 'required', headerName: 'Required', type: 'boolean', editable: true, width: 80 },\n            {\n                field: 'actions',\n                type: 'actions',\n                width: 80,\n                getActions: (params) => [\n                    <GridActionsCellItem key={'Delete'} icon={<DeleteIcon />} label='Delete' onClick={deleteItem(params.id)} />\n                ]\n            }\n        ],\n        [deleteItem]\n    )\n\n    const formatSchema = (schema) => {\n        try {\n            const parsedSchema = JSON.parse(schema)\n            return parsedSchema.map((sch, index) => {\n                return {\n                    ...sch,\n                    id: index\n                }\n            })\n        } catch (e) {\n            return []\n        }\n    }\n\n    useEffect(() => {\n        if (getSpecificToolApi.data) {\n            setToolId(getSpecificToolApi.data.id)\n            setToolName(getSpecificToolApi.data.name)\n            setToolDesc(getSpecificToolApi.data.description)\n            setToolSchema(formatSchema(getSpecificToolApi.data.schema))\n            if (getSpecificToolApi.data.func) setToolFunc(getSpecificToolApi.data.func)\n            else setToolFunc('')\n        }\n    }, [getSpecificToolApi.data])\n\n    useEffect(() => {\n        if (dialogProps.type === 'EDIT' && dialogProps.data) {\n            // When tool dialog is opened from Tools dashboard\n            setToolId(dialogProps.data.id)\n            setToolName(dialogProps.data.name)\n            setToolDesc(dialogProps.data.description)\n            setToolIcon(dialogProps.data.iconSrc)\n            setToolSchema(formatSchema(dialogProps.data.schema))\n            if (dialogProps.data.func) setToolFunc(dialogProps.data.func)\n            else setToolFunc('')\n        } else if (dialogProps.type === 'EDIT' && dialogProps.toolId) {\n            // When tool dialog is opened from CustomTool node in canvas\n            getSpecificToolApi.request(dialogProps.toolId)\n        } else if (dialogProps.type === 'IMPORT' && dialogProps.data) {\n            // When tool dialog is to import existing tool\n            setToolName(dialogProps.data.name)\n            setToolDesc(dialogProps.data.description)\n            setToolIcon(dialogProps.data.iconSrc)\n            setToolSchema(formatSchema(dialogProps.data.schema))\n            if (dialogProps.data.func) setToolFunc(dialogProps.data.func)\n            else setToolFunc('')\n        } else if (dialogProps.type === 'TEMPLATE' && dialogProps.data) {\n            // When tool dialog is a template\n            setToolName(dialogProps.data.name)\n            setToolDesc(dialogProps.data.description)\n            setToolIcon(dialogProps.data.iconSrc)\n            setToolSchema(formatSchema(dialogProps.data.schema))\n            if (dialogProps.data.func) setToolFunc(dialogProps.data.func)\n            else setToolFunc('')\n        } else if (dialogProps.type === 'ADD') {\n            // When tool dialog is to add a new tool\n            setToolId('')\n            setToolName('')\n            setToolDesc('')\n            setToolIcon('')\n            setToolSchema([])\n            setToolFunc('')\n        }\n\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [dialogProps])\n\n    const useToolTemplate = () => {\n        onUseTemplate(dialogProps.data)\n    }\n\n    const exportTool = async () => {\n        try {\n            const toolResp = await toolsApi.getSpecificTool(toolId)\n            if (toolResp.data) {\n                const toolData = toolResp.data\n                delete toolData.id\n                delete toolData.createdDate\n                delete toolData.updatedDate\n                let dataStr = JSON.stringify(toolData)\n                let dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr)\n\n                let exportFileDefaultName = `${toolName}-CustomTool.json`\n\n                let linkElement = document.createElement('a')\n                linkElement.setAttribute('href', dataUri)\n                linkElement.setAttribute('download', exportFileDefaultName)\n                linkElement.click()\n            }\n        } catch (error) {\n            const errorData = error.response.data || `${error.response.status}: ${error.response.statusText}`\n            enqueueSnackbar({\n                message: `Failed to export Tool: ${errorData}`,\n                options: {\n                    key: new Date().getTime() + Math.random(),\n                    variant: 'error',\n                    persist: true,\n                    action: (key) => (\n                        <Button style={{ color: 'white' }} onClick={() => closeSnackbar(key)}>\n                            <IconX />\n                        </Button>\n                    )\n                }\n            })\n            onCancel()\n        }\n    }\n\n    const addNewTool = async () => {\n        try {\n            const obj = {\n                name: toolName,\n                description: toolDesc,\n                color: generateRandomGradient(),\n                schema: JSON.stringify(toolSchema),\n                func: toolFunc,\n                iconSrc: toolIcon\n            }\n            const createResp = await toolsApi.createNewTool(obj)\n            if (createResp.data) {\n                enqueueSnackbar({\n                    message: 'New Tool added',\n                    options: {\n                        key: new Date().getTime() + Math.random(),\n                        variant: 'success',\n                        action: (key) => (\n                            <Button style={{ color: 'white' }} onClick={() => closeSnackbar(key)}>\n                                <IconX />\n                            </Button>\n                        )\n                    }\n                })\n                onConfirm(createResp.data.id)\n            }\n        } catch (error) {\n            const errorData = error.response.data || `${error.response.status}: ${error.response.statusText}`\n            enqueueSnackbar({\n                message: `Failed to add new Tool: ${errorData}`,\n                options: {\n                    key: new Date().getTime() + Math.random(),\n                    variant: 'error',\n                    persist: true,\n                    action: (key) => (\n                        <Button style={{ color: 'white' }} onClick={() => closeSnackbar(key)}>\n                            <IconX />\n                        </Button>\n                    )\n                }\n            })\n            onCancel()\n        }\n    }\n\n    const saveTool = async () => {\n        try {\n            const saveResp = await toolsApi.updateTool(toolId, {\n                name: toolName,\n                description: toolDesc,\n                schema: JSON.stringify(toolSchema),\n                func: toolFunc,\n                iconSrc: toolIcon\n            })\n            if (saveResp.data) {\n                enqueueSnackbar({\n                    message: 'Tool saved',\n                    options: {\n                        key: new Date().getTime() + Math.random(),\n                        variant: 'success',\n                        action: (key) => (\n                            <Button style={{ color: 'white' }} onClick={() => closeSnackbar(key)}>\n                                <IconX />\n                            </Button>\n                        )\n                    }\n                })\n                onConfirm(saveResp.data.id)\n            }\n        } catch (error) {\n            console.error(error)\n            const errorData = error.response.data || `${error.response.status}: ${error.response.statusText}`\n            enqueueSnackbar({\n                message: `Failed to save Tool: ${errorData}`,\n                options: {\n                    key: new Date().getTime() + Math.random(),\n                    variant: 'error',\n                    persist: true,\n                    action: (key) => (\n                        <Button style={{ color: 'white' }} onClick={() => closeSnackbar(key)}>\n                            <IconX />\n                        </Button>\n                    )\n                }\n            })\n            onCancel()\n        }\n    }\n\n    const deleteTool = async () => {\n        const confirmPayload = {\n            title: `Delete Tool`,\n            description: `Delete tool ${toolName}?`,\n            confirmButtonName: 'Delete',\n            cancelButtonName: 'Cancel'\n        }\n        const isConfirmed = await confirm(confirmPayload)\n\n        if (isConfirmed) {\n            try {\n                const delResp = await toolsApi.deleteTool(toolId)\n                if (delResp.data) {\n                    enqueueSnackbar({\n                        message: 'Tool deleted',\n                        options: {\n                            key: new Date().getTime() + Math.random(),\n                            variant: 'success',\n                            action: (key) => (\n                                <Button style={{ color: 'white' }} onClick={() => closeSnackbar(key)}>\n                                    <IconX />\n                                </Button>\n                            )\n                        }\n                    })\n                    onConfirm()\n                }\n            } catch (error) {\n                const errorData = error.response.data || `${error.response.status}: ${error.response.statusText}`\n                enqueueSnackbar({\n                    message: `Failed to delete Tool: ${errorData}`,\n                    options: {\n                        key: new Date().getTime() + Math.random(),\n                        variant: 'error',\n                        persist: true,\n                        action: (key) => (\n                            <Button style={{ color: 'white' }} onClick={() => closeSnackbar(key)}>\n                                <IconX />\n                            </Button>\n                        )\n                    }\n                })\n                onCancel()\n            }\n        }\n    }\n\n    const component = show ? (\n        <Dialog\n            fullWidth\n            maxWidth='md'\n            open={show}\n            onClose={onCancel}\n            aria-labelledby='alert-dialog-title'\n            aria-describedby='alert-dialog-description'\n        >\n            <DialogTitle sx={{ fontSize: '1rem' }} id='alert-dialog-title'>\n                <div style={{ display: 'flex', flexDirection: 'row' }}>\n                    {dialogProps.title}\n                    <div style={{ flex: 1 }} />\n                    {dialogProps.type === 'EDIT' && (\n                        <Button variant='outlined' onClick={() => exportTool()} startIcon={<IconFileExport />}>\n                            Export\n                        </Button>\n                    )}\n                </div>\n            </DialogTitle>\n            <DialogContent>\n                <Box sx={{ p: 2 }}>\n                    <Stack sx={{ position: 'relative' }} direction='row'>\n                        <Typography variant='overline'>\n                            Tool Name\n                            <span style={{ color: 'red' }}>&nbsp;*</span>\n                            <TooltipWithParser\n                                style={{ marginLeft: 10 }}\n                                title={'Tool name must be small capital letter with underscore. Ex: my_tool'}\n                            />\n                        </Typography>\n                    </Stack>\n                    <OutlinedInput\n                        id='toolName'\n                        type='string'\n                        fullWidth\n                        disabled={dialogProps.type === 'TEMPLATE'}\n                        placeholder='My New Tool'\n                        value={toolName}\n                        name='toolName'\n                        onChange={(e) => setToolName(e.target.value)}\n                    />\n                </Box>\n                <Box sx={{ p: 2 }}>\n                    <Stack sx={{ position: 'relative' }} direction='row'>\n                        <Typography variant='overline'>\n                            Tool description\n                            <span style={{ color: 'red' }}>&nbsp;*</span>\n                            <TooltipWithParser\n                                style={{ marginLeft: 10 }}\n                                title={'Description of what the tool does. This is for ChatGPT to determine when to use this tool.'}\n                            />\n                        </Typography>\n                    </Stack>\n                    <OutlinedInput\n                        id='toolDesc'\n                        type='string'\n                        fullWidth\n                        disabled={dialogProps.type === 'TEMPLATE'}\n                        placeholder='Description of what the tool does. This is for ChatGPT to determine when to use this tool.'\n                        multiline={true}\n                        rows={3}\n                        value={toolDesc}\n                        name='toolDesc'\n                        onChange={(e) => setToolDesc(e.target.value)}\n                    />\n                </Box>\n                <Box sx={{ p: 2 }}>\n                    <Stack sx={{ position: 'relative' }} direction='row'>\n                        <Typography variant='overline'>Tool Icon Src</Typography>\n                    </Stack>\n                    <OutlinedInput\n                        id='toolIcon'\n                        type='string'\n                        fullWidth\n                        disabled={dialogProps.type === 'TEMPLATE'}\n                        placeholder='https://raw.githubusercontent.com/gilbarbara/logos/main/logos/airtable.svg'\n                        value={toolIcon}\n                        name='toolIcon'\n                        onChange={(e) => setToolIcon(e.target.value)}\n                    />\n                </Box>\n                <Box sx={{ p: 2 }}>\n                    <Stack sx={{ position: 'relative' }} direction='row'>\n                        <Typography variant='overline'>\n                            Output Schema\n                            <TooltipWithParser style={{ marginLeft: 10 }} title={'What should be the output response in JSON format?'} />\n                        </Typography>\n                    </Stack>\n                    <Grid\n                        columns={columns}\n                        rows={toolSchema}\n                        disabled={dialogProps.type === 'TEMPLATE'}\n                        addNewRow={addNewRow}\n                        onRowUpdate={onRowUpdate}\n                    />\n                </Box>\n                <Box sx={{ p: 2 }}>\n                    <Stack sx={{ position: 'relative' }} direction='row'>\n                        <Typography variant='overline'>\n                            Javascript Function\n                            <TooltipWithParser\n                                style={{ marginLeft: 10 }}\n                                title='Function to execute when tool is being used. You can use properties specified in Output Schema as variables. For example, if the property is <code>userid</code>, you can use as <code>$userid</code>. Return value must be a string.'\n                            />\n                        </Typography>\n                    </Stack>\n                    {dialogProps.type !== 'TEMPLATE' && (\n                        <Button style={{ marginBottom: 10 }} variant='outlined' onClick={() => setToolFunc(exampleAPIFunc)}>\n                            See Example\n                        </Button>\n                    )}\n                    {customization.isDarkMode ? (\n                        <DarkCodeEditor\n                            value={toolFunc}\n                            disabled={dialogProps.type === 'TEMPLATE'}\n                            onValueChange={(code) => setToolFunc(code)}\n                            style={{\n                                fontSize: '0.875rem',\n                                minHeight: 'calc(100vh - 220px)',\n                                width: '100%',\n                                borderRadius: 5\n                            }}\n                        />\n                    ) : (\n                        <LightCodeEditor\n                            value={toolFunc}\n                            disabled={dialogProps.type === 'TEMPLATE'}\n                            onValueChange={(code) => setToolFunc(code)}\n                            style={{\n                                fontSize: '0.875rem',\n                                minHeight: 'calc(100vh - 220px)',\n                                width: '100%',\n                                border: `1px solid ${theme.palette.grey[300]}`,\n                                borderRadius: 5\n                            }}\n                        />\n                    )}\n                </Box>\n            </DialogContent>\n            <DialogActions>\n                {dialogProps.type === 'EDIT' && (\n                    <StyledButton color='error' variant='contained' onClick={() => deleteTool()}>\n                        Delete\n                    </StyledButton>\n                )}\n                {dialogProps.type === 'TEMPLATE' && (\n                    <StyledButton color='secondary' variant='contained' onClick={useToolTemplate}>\n                        Use Template\n                    </StyledButton>\n                )}\n                {dialogProps.type !== 'TEMPLATE' && (\n                    <StyledButton\n                        disabled={!(toolName && toolDesc)}\n                        variant='contained'\n                        onClick={() => (dialogProps.type === 'ADD' || dialogProps.type === 'IMPORT' ? addNewTool() : saveTool())}\n                    >\n                        {dialogProps.confirmButtonName}\n                    </StyledButton>\n                )}\n            </DialogActions>\n            <ConfirmDialog />\n        </Dialog>\n    ) : null\n\n    return createPortal(component, portalElement)\n}\n\nToolDialog.propTypes = {\n    show: PropTypes.bool,\n    dialogProps: PropTypes.object,\n    onUseTemplate: PropTypes.func,\n    onCancel: PropTypes.func,\n    onConfirm: PropTypes.func\n}\n\nexport default ToolDialog\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}